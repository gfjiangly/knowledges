## 数据的机内表示

### 二进制表示

1. 机器数

   由于计算机中符号和数字一样,都必须用二进制数串来表示,因此,正负号也必须用0、1来表示。

   用最高位0表示正、1表示负, 这种正负号数字化的机内表示形式就称为“机器数”,而相应的机器外部用正负号表示的数称为“真值”,将一个真值表示成二进制字串的机器数的过程就称为编码。

2. 原码

   原码就是符号位加上真值的绝对值, 即用第一位表示符号, 其余位表示值. 比如如果是8位二进制:

   [+1]原 = 0000 0001

   [-1]原 = 1000 0001

   第一位是符号位. 因为第一位是符号位, 所以8位二进制数的取值范围就是:

   [1111 1111 , 0111 1111]

   即

   [-127 , 127]

   原码是人脑最容易理解和计算的表示方式

3. 反码

   反码的表示方法是:

   正数的反码是其本身

   负数的反码是在其原码的基础上, 符号位不变，其余各个位取反.

   [+1] = [00000001]原 = [00000001]反

   [-1] = [10000001]原 = [11111110]反

   可见如果一个反码表示的是负数, 人脑无法直观的看出来它的数值. 通常要将其转换成原码再计算

4. 补码

   补码的表示方法是:

   正数的补码就是其本身

   负数的补码是在其原码的基础上, 符号位不变, 其余各位取反, 最后+1。 (即在反码的基础上+1)

   [+1] = [00000001]原 = [00000001]反 = [00000001]补

   [-1] = [10000001]原 = [11111110]反 = [11111111]补

   对于负数, 补码表示方式也是人脑无法直观看出其数值的. 通常也需要转换成原码在计算其数值.

### 位运算

计算机内部运算时，数字都是以补码的形式表示。因此当涉及负数的位运算时，结果是以补码形式表示，真正的数值要转成原码才能被人理解。例如：

1. 取反

```cpp
// 取反运算
int a = 1;
int b = ~a;  // b为 1111 ... 1110, 但这是补码形式，其反码即补码-1：1111 ... 1101，原码为：1000 ... 0001
printf("%d\n", b);  // 因此打印的结果为-1
```

2. 移位

- 负数的右移：需要保持数为负数，所以操作是对负数的二进制位左边补1。如果一直右移，最终会变成-1，即(-1)>>1是-1。
- 负数的左移：负数左移不会特殊处理符号位。如果一直左移，最终会变成0。和整数左移一样，在负数的二进制位右边补0，一个数在左移的过程中会有正有负的情况。

```cpp
// 一定要把a先写成补码形式再移位，然后再把结果写成人能理解的原码形式
int a = -1;  // 在计算机中表示为 1[~(000 ... 0001)+1]=1111 ... 1111
int b = a >> 1;  // 右移1位还是 1111 1111
```

3. 与或运算

```cpp
a = -2;  // 1[~000 ... 0010 + 1] = 1111 ... 1110
b = a & 3;   // 1111 ... 1110 & 0000 0011 = 0000 ... 0010
printf("%d\n", b);  // b为2
```

